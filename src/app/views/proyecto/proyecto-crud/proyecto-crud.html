<p-toast></p-toast>
<div class="container">
  <form class="row g-3 needs-validation" [formGroup]="form" (ngSubmit)="accion($event)" novalidate>
    <div class="col-md-6" hidden>
      <label for="id" class="form-label">Id</label>
      <input
        id="id"
        type="text"
        formControlName="id"
        class="form-control"
        placeholder="id"
      />
      @if (get('id')?.invalid && get('id')?.touched) {
        <div class="invalid-feedback">Debe ingresar un id.</div>
      }
    </div>

    <div class="col-md-4">
      <label for="sigla" class="form-label">Sigla</label>
      <input
        id="sigla"
        type="text"
        formControlName="sigla"
        class="form-control"
        placeholder="sigla"
        required
        (input)="onUppercaseInput($event, 'sigla')"
      />
      @if (get('sigla')?.invalid && get('sigla')?.touched) {
        <div class="invalid-feedback">Debe ingresar un sigla v√°lido.</div>
      }
    </div>

    <div class="col-md-4">
      <label for="nombre" class="form-label">Nombre</label>
      <input
        id="nombre"
        type="text"
        formControlName="nombre"
        class="form-control"
        placeholder="nombre"
        required
      />
      @if (get('nombre')?.invalid && get('nombre')?.touched) {
        <div class="invalid-feedback">Debe ingresar un nombre.</div>
      }
    </div>

    <div class="col-md-4">
      <label for="clienteIds" class="form-label">Clientes</label>
      <p-multiSelect
        id="clienteIds"
        formControlName="clienteIds"
        [options]="clientes"
        optionLabel="nombre"
        optionValue="id"
        placeholder="Seleccionar clientes"
        display="chip"
        [filter]="true"
        filterPlaceholder="Buscar cliente..."
        styleClass="w-100"
        appendTo="body"
      >
        <ng-template let-cliente pTemplate="item">
          <div class="flex align-items-center gap-2">
            <span><strong>{{ cliente.sigla }}</strong> - {{ cliente.nombre }}</span>
          </div>
        </ng-template>
      </p-multiSelect>
      @if (get('clienteIds')?.invalid && get('clienteIds')?.touched) {
        <div class="invalid-feedback d-block">Debe seleccionar al menos un cliente.</div>
      }
    </div>

    <div class="col-md-4">
        <label for="activo" class="form-label">Activo</label>
        <div class="mb-2">
          <input id="activo" type="checkbox" formControlName="activo" class="btn-check" />
          <label class="btn btn-outline-primary" for="activo">
            @if (get('activo')?.value){
            ACTIVO
            } @else {
            DESACTIVO
            }
          </label>
        </div>
    </div>

    <div class="col-md-4">
        <label for="critico" class="form-label">Critico</label>
        <div class="mb-2">
            <input id="critico" type="checkbox" formControlName="critico" class="btn-check" />
            <label class="btn" [ngClass]="get('critico')?.value ? 'btn-outline-danger' : 'btn-outline-primary'" for="critico">
              @if (get('critico')?.value){
              CRITICO
              } @else {
              NO CRITICO
              }
            </label>
        </div>
    </div>

    <div class="col-12 mb-5">
      <button class="btn btn-primary" type="submit">
        @if (modo === 'A') {
          Crear
        } @else if (modo === 'M') {
          Modificar
        }
      </button>
    </div>
  </form>
</div>
